<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>抽獎紀錄寫入 Google Sheet</title>
</head>
<body>
  <h2>抽獎登記</h2>
  暱稱：<input type="text" id="nickname"><br>
  獎項：
  <select id="prize">
    <option value="一等獎">🎉 一等獎</option>
    <option value="二等獎">🎁 二等獎</option>
    <option value="三等獎">🥳 三等獎</option>
  </select><br><br>
  <button onclick="submitLottery()">送出</button>

  <script>
    function submitLottery() {
      const nickname = document.getElementById("nickname").value.trim();
      const prize = document.getElementById("prize").value;
      if (!nickname) {
        alert("請輸入暱稱！");
        return;
      }

      fetch("https://script.google.com/macros/s/AKfycbx4jYIV_U-sgfUE17idG95NroXAEvCKGv_RPDL-hzFhQTk_px4tIslGkOAf3tMKHyZu/exec", {
        method: "POST",
        body: JSON.stringify({ nickname, prize }),
        headers: {
          "Content-Type": "application/json"
        }
      })
      .then(res => res.text())
      .then(txt => {
        alert("抽獎已登記成功！");
        document.getElementById("nickname").value = "";
      })
      .catch(err => {
        console.error("發生錯誤", err);
        alert("寫入失敗，請稍後再試！");
      });
    }
  </script>
</body>
</html>

